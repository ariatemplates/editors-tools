_dop_ stands for _Data Oriented Programming_. I didn't find any better name.

The thing is to work more nicely with properties, and more generally with types.

# TODO

* be able to specify a set of properties with an object when properties all have only one name, with mapToArray...

# Properties management

## Process properties

`processProperties`

Processes inputs to generate spec objects.

The general workfow is this one:

- you build an object by sending a value to the constructor
- this value can be either a factory, which has to be converted to a spec object
- or directly an object
- the new object being built takes properties from the spec object, which can have a different form (more flexibe, since this is made _by hand_ by the user)

The output is the object being built, the input is any suitable value regarding your rules, and the rules contains both rules to convert the input to a proper spec object and to extract properties from the latter.

See:

* `inputToSpec`
* `applyProperties`

## Input to spec factory

`inputToSpec`

Converts any input value to a spec object (kind of factory), thanks to a set of rules.

### Rules

Rules for now are simple. For a given input type, you can do one of the following:

- specify to which property of the output spec object the given input value will go
- specify a handler function that will get the input value and return the spec it builds itself

Example:

```javascript
var rule = {
	'String': 'str',
	'Number': 'nb',
	'Boolean': function(input) {
		return {
		val: input ? 1 : 0
		}
	}
};
inputToSpec('a string', rules); // => {str: 'a string'}
inputToSpec(5, rules); // => {nb: 5}
inputToSpec(true, rules); // => {val: 1}
inputToSpec(false, rules); // => {val: 0}
```

There are two default rules:

- if the given input is an object, it is considered as being a spec already (no way to determine it is not, except by checking with more semantics, but this is complex and the user would have to give lots of rules - schemas for instance)
- if nothings matches, an empty object is returned

## Property processing

`extractProperty`

Extracts a property from a spec object, thanks to a property specifications, and puts the result in the output object.

### Property specifications

A property has a list of names, that the user can use in the spec.

The order of names is important since it has a precedence.

The first name of the list is used by default as the name of the property in the output.

If no value was defined in the spec for the property, this is not set in the output object (no explicit undefined properties)

### FIXME

When a property is extracted from the given spec, if no suitable property value was found in this spec, the spec itself is used as the property - remember it is just used as input for a factory.

For instance, specifying:

```javascript
{
	color: {
		r,
		g,
		b
	},
	font
}
```

will work as well as:

```javascript
{
	r,
	g,
	b,
	font
}
``` directly.

HOWEVER this brings a problem when you want to actually bypass a value, set is as undefined. Take the second object and imagine `{r, g, b}` were user-specific extra properties, not the spec for the color. Or imagine there is nothing at all for the color (`{font}`). When trying to build the color property, it should fail.

The user should specify more rules to handle this properly.

For now, the user can specify `null`.
